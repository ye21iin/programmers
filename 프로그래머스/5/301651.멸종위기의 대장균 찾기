WITH RECURSIVE GENERATIONS AS (
    SELECT ID, 1 AS GENERATION
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NULL

    UNION ALL
    
    SELECT E.ID, R.GENERATION + 1 AS GENERATION
    FROM ECOLI_DATA E, GENERATIONS R 
    WHERE E.PARENT_ID = R.ID    
)
, NOT_PARENT_ID AS (
SELECT A.ID 
FROM (
    SELECT ID, PARENT_ID,
    CASE
    WHEN ID IN (SELECT PARENT_ID FROM ECOLI_DATA) THEN 1
    ELSE 0 END AS IS_PARENT
    FROM ECOLI_DATA
) A
WHERE A.IS_PARENT = 0
)

SELECT COUNT(*) AS COUNT, GENERATION
FROM GENERATIONS G
INNER JOIN NOT_PARENT_ID N ON G.ID = N.ID
GROUP BY GENERATION
ORDER BY 2
