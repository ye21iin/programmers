SELECT 
    TO_CHAR(S.SALES_DATE, 'YYYY') AS YEAR,
    EXTRACT(MONTH FROM S.SALES_DATE) AS MONTH,
    U.GENDER,
    COUNT(DISTINCT S.USER_ID) AS USERS
FROM ONLINE_SALE S
JOIN USER_INFO U ON S.USER_ID = U.USER_ID AND U.GENDER IS NOT NULL
GROUP BY TO_CHAR(S.SALES_DATE, 'YYYY'),
    EXTRACT(MONTH FROM S.SALES_DATE),
    U.GENDER
ORDER BY 1,2,3
