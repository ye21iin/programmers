WITH FRONT AS (SELECT BIT_OR(CODE) AS CODE FROM SKILLCODES WHERE CATEGORY = 'Front End'),
PYTHON AS (SELECT CODE FROM SKILLCODES WHERE NAME = 'Python'),
CSHARP AS (SELECT CODE FROM SKILLCODES WHERE NAME = 'C#')

SELECT 
    A.GRADE, A.ID, A.EMAIL
FROM (
SELECT
    CASE
        WHEN D.SKILL_CODE & F.CODE > 0 AND D.SKILL_CODE & P.CODE > 0 THEN 'A'
        WHEN D.SKILL_CODE & C.CODE > 0 THEN 'B'
        WHEN D.SKILL_CODE & F.CODE > 0 THEN 'C'
    END AS GRADE,
    D.ID, D.EMAIL
FROM DEVELOPERS D
JOIN FRONT F JOIN PYTHON P JOIN CSHARP C
) A WHERE A.GRADE IS NOT NULL
ORDER BY 1, 2
;
