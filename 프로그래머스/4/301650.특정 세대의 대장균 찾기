WITH RECURSIVE CTE AS ( 
    SELECT ID, PARENT_ID, 1 AS GEN
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NULL
UNION ALL
SELECT 
    E.ID, E.PARENT_ID, C.GEN + 1 AS GEN
FROM ECOLI_DATA E
    JOIN CTE C ON E.PARENT_ID = C.ID
WHERE C.GEN < 3
)
SELECT ID FROM CTE WHERE GEN = 3 ORDER BY 1
